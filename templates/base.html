<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>INFLUE ‚Äî Assistente de Imagem & Engajamento</title>
  <meta name="description" content="Analise sua foto ou texto antes de postar. Proteja sua imagem e alavanque seu engajamento." />

  <!-- Favicon / App icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/static/logo/influe_logo.png" />
  <link rel="apple-touch-icon" href="/static/logo/influe_logo.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
</head>
<body class="theme-dark">
  <a class="skip-link" href="#conteudo-principal">Ir para o conte√∫do</a>

  <header class="topbar">
    <div class="container flex between center-v topbar-row">
      <div class="flex center-v" style="gap:.5rem;">
        <!-- Bot√£o de 3 pontinhos (abre/fecha sidebar) -->
        <button id="sidebar-toggle" class="btn btn-icon" type="button" aria-label="Abrir painel"
                title="Abrir painel" style="display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;border-radius:999px;background:rgba(31,128,255,.25);border:1px solid rgba(148,163,184,.25);color:#fff;">
          <span style="font-size:18px;letter-spacing:2px;line-height:0;">‚Ä¢‚Ä¢‚Ä¢</span>
        </button>

        <a class="brand flex center-v" href="/" aria-label="Ir para in√≠cio">
          <img class="logo-img" src="/static/logo/influe_logo.png" alt="INFLUE" width="34" height="34" loading="eager" decoding="async" />
          <span class="brandtext" style="display:flex;flex-direction:column;line-height:1;">
            <strong>INFLUE</strong>
            <small class="muted" style="font-size:.75rem;margin-top:.15rem;">Bem-vindo ao INFLUE</small>
          </span>
        </a>
      </div>

      <nav class="auth flex wrap center-v" style="gap:.5rem;">
        <span id="user-state" class="pill" title="Estado de sess√£o">
          <svg width="10" height="10" viewBox="0 0 10 10" aria-hidden="true"><circle cx="5" cy="5" r="5" fill="#6aa8ff"/></svg>
          <span id="user-label">Convidado</span>
        </span>

        <span class="muted">
          Cr√©ditos:
          <strong id="credits-left" data-credits="{{ credits_left|default(0) }}">
            Sess√£o: {{ credits_left|default(0) }} | Usu√°rio: ‚Äî
          </strong>
        </span>

        <!-- ‚úÖ Altera√ß√£o cir√∫rgica: texto ajustado para "+ 10 cr√©ditos" -->
        <button id="btn-purchase" class="btn btn-primary" type="button" title="Comprar cr√©ditos" style="display:none;">
          + 10 cr√©ditos
        </button>
        <a id="btn-buy-link" class="btn btn-primary" href="/buy" title="Ir para a p√°gina de compra">
          + 10 cr√©ditos
        </a>

        <button id="btn-open-auth" class="btn btn-ghost" type="button">Entrar / Criar conta</button>
        <button id="btn-logout" class="btn btn-ghost" type="button" style="display:none;">Sair</button>
      </nav>
    </div>
  </header>

  {% block hero %}{% endblock %}
  <main id="conteudo-principal" class="main">
    {% block content %}{% endblock %}
  </main>

  <footer class="footer">
    <div class="container flex between center-v wrap footer-row">
      <small>¬© <span id="year"></span> INFLUE. Todos os direitos reservados.</small>
      <small class="muted">Pol√≠tica de Privacidade ‚Ä¢ <a class="link" href="/privacy">/privacy</a></small>
    </div>
  </footer>

  <!-- Overlay e Sidebar (estrutura; conte√∫do preenchido via JS) -->
  <div id="influe-sidebar-overlay" aria-hidden="true"></div>
  <aside id="influe-sidebar" aria-hidden="true" aria-label="Painel do usu√°rio INFLUE">
    <div class="sidebar-header">
      <div class="title">üìä Sidebar Inteligente</div>
      <button id="sidebar-close" class="btn btn-ghost" type="button" aria-label="Fechar">Fechar</button>
    </div>

    <div class="sidebar-content">
      <!-- 1. Raip√¥metro -->
      <section id="sb-raipometro" class="sb-card">
        <div class="sb-card-title">‚ö° Raip√¥metro</div>
        <div id="sb-rai-thermo" class="thermo">
          <div class="thermo-bar"><span class="thermo-pct">0%</span></div>
        </div>
        <div class="sb-metrics">
          <div><small class="muted">M√©dia das √∫ltimas fotos</small><div id="sb-rai-media" class="metric">‚Äî</div></div>
          <div><small class="muted">Tend√™ncia</small><div id="sb-rai-trend" class="metric">‚Äî</div></div>
        </div>
        <p id="sb-rai-msg" class="muted" style="margin-top:.5rem;">‚Äî</p>
      </section>

      <!-- 2. Novas an√°lises -->
      <section class="sb-card">
        <div class="sb-card-title">üì∑ Novas An√°lises</div>
        <button id="sb-new-analysis" class="btn btn-primary" type="button">+ Nova An√°lise</button>
        <div id="sb-credits-chip" class="chip" style="margin-top:.5rem;">Cr√©ditos: ‚Äî</div>
        <small class="muted" title="Cada an√°lise consome 1 cr√©dito. Voc√™ ganha 3 cr√©ditos ao se cadastrar.">
          Cada an√°lise consome 1 cr√©dito. Voc√™ ganha 3 cr√©ditos ao se cadastrar.
        </small>
      </section>

      <!-- 3. √öltimas an√°lises -->
      <section class="sb-card">
        <div class="sb-card-title">üïì √öltimas An√°lises</div>
        <ul id="sb-last-list" class="sb-list"></ul>
      </section>

      <!-- 4. Hist√≥rico -->
      <section class="sb-card">
        <div class="sb-card-title">üìÅ Hist√≥rico</div>
        <div class="sb-filters">
          <select id="sb-filter-type" aria-label="Filtrar por tipo">
            <option value="">Todos</option>
            <option value="photo">Foto</option>
            <option value="text">Texto</option>
          </select>
          <select id="sb-filter-status" aria-label="Filtrar por status">
            <option value="">Todos</option>
            <option value="pos">Positiva</option>
            <option value="neu">Neutra</option>
            <option value="risco">Risco</option>
          </select>
        </div>
        <div id="sb-hist-count" class="muted" style="margin:.5rem 0;">Total de an√°lises realizadas: ‚Äî</div>
        <button id="sb-export" class="btn btn-outline" type="button" disabled title="Fun√ß√£o dispon√≠vel em breve">
          Exportar PDF
        </button>
      </section>

      <!-- 5. Cr√©ditos & Atividade -->
      <section class="sb-card">
        <div class="sb-card-title">üí≥ Cr√©ditos & Atividade (60 dias)</div>
        <div id="sb-donut" class="donut-wrap" aria-label="Resumo de cr√©ditos">
          <!-- SVG din√¢mico via JS -->
        </div>
        <ul id="sb-credits-msgs" class="muted" style="margin-top:.5rem;"></ul>
      </section>

      <!-- 6. Rodap√© informativo -->
      <section class="sb-card" style="opacity:.9;">
        <small class="muted">
          O portal INFLUE √© seu assistente inteligente de imagem. Proteja sua marca e amplifique seu impacto digital.
          <a class="link" href="/privacy">Saiba mais</a>
        </small>
      </section>
    </div>
  </aside>

  <!-- Modal backdrop -->
  <div id="auth-backdrop" class="modal-backdrop" aria-hidden="true"></div>

  <!-- Modal de Autentica√ß√£o (inalterado) -->
  <section id="auth-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="auth-title" aria-hidden="true">
    <div class="panel">
      <div class="flex between center-v">
        <h2 id="auth-title" style="margin:.25rem 0 0;">Acessar INFLUE</h2>
        <button id="auth-close" class="btn btn-ghost" type="button" aria-label="Fechar">Fechar</button>
      </div>

      <div class="tabs" role="tablist" aria-label="Op√ß√µes de autentica√ß√£o">
        <div id="tab-login"  class="tab active" role="tab" aria-selected="true"  tabindex="0">Entrar</div>
        <div id="tab-signup" class="tab"        role="tab" aria-selected="false" tabindex="-1">Criar conta</div>
      </div>

      <!-- ENTRAR -->
      <form id="form-login" class="form" autocomplete="on">
        <div class="field">
          <label for="auth-email" class="muted">E-mail</label>
          <input id="auth-email" type="email" placeholder="voce@exemplo.com" autocomplete="email" required />
        </div>
        <div class="field">
          <label for="auth-password" class="muted">Senha</label>
          <input id="auth-password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" required />
        </div>
        <div class="form-actions">
          <button id="btn-login" class="btn btn-primary" type="submit">Entrar</button>
        </div>
        <p class="hint" style="margin:.25rem 0 0;">Ainda n√£o √© cadastrado?
          <span id="link-open-signup" class="muted-link">Crie sua conta agora</span>.
        </p>
      </form>

      <!-- CRIAR CONTA -->
      <form id="form-signup" class="form" style="display:none;" autocomplete="on">
        <div class="field">
          <label for="reg-email" class="muted">E-mail</label>
          <input id="reg-email" type="email" placeholder="voce@exemplo.com" autocomplete="email" required />
        </div>
        <div class="field">
          <label for="reg-email2" class="muted">Confirmar e-mail</label>
          <input id="reg-email2" type="email" placeholder="voce@exemplo.com" autocomplete="email" required />
        </div>
        <div class="field">
          <label for="reg-pass" class="muted">Senha</label>
          <input id="reg-pass" type="password" placeholder="M√≠nimo 6 caracteres" autocomplete="new-password" required />
        </div>
        <div class="field">
          <label for="reg-pass2" class="muted">Confirmar senha</label>
          <input id="reg-pass2" type="password" placeholder="Repita a senha" autocomplete="new-password" required />
        </div>
        <div class="form-actions">
          <button id="btn-register" class="btn btn-primary" type="submit">Criar conta</button>
        </div>
        <p class="hint" style="margin:.25rem 0 0;">J√° possui cadastro?
          <span id="link-open-login" class="muted-link">Entrar</span>.
        </p>
      </form>

      <div id="auth-feedback" class="muted" role="status" aria-live="polite" style="min-height:1.25rem;"></div>
      <div class="divider"></div>
      <small class="muted">Ao continuar, voc√™ concorda com nossos termos e a pol√≠tica de privacidade.</small>
    </div>
  </section>

  <script>
    (function(){
      const modal = document.getElementById('auth-modal');
      const backdrop = document.getElementById('auth-backdrop');
      const openBtn = document.getElementById('btn-open-auth');
      const closeBtn = document.getElementById('auth-close');
      const tabLogin  = document.getElementById('tab-login');
      const tabSignup = document.getElementById('tab-signup');
      const formLogin  = document.getElementById('form-login');
      const formSignup = document.getElementById('form-signup');
      const linkOpenSignup = document.getElementById('link-open-signup');
      const linkOpenLogin  = document.getElementById('link-open-login');

      function showModal(){ modal.classList.add('show'); backdrop.classList.add('show'); }
      function hideModal(){ modal.classList.remove('show'); backdrop.classList.remove('show'); }
      function setTab(mode){
        const isLogin = mode === 'login';
        tabLogin.classList.toggle('active', isLogin);
        tabSignup.classList.toggle('active', !isLogin);
        tabLogin.setAttribute('aria-selected', isLogin ? 'true':'false');
        tabSignup.setAttribute('aria-selected', !isLogin ? 'true':'false');
        formLogin.style.display  = isLogin ? '' : 'none';
        formSignup.style.display = isLogin ? 'none' : '';
      }

      openBtn?.addEventListener('click', showModal);
      closeBtn?.addEventListener('click', hideModal);
      backdrop?.addEventListener('click', hideModal);
      document.addEventListener('keydown', e => { if(e.key==='Escape') hideModal(); });
      tabLogin?.addEventListener('click', ()=>setTab('login'));
      tabSignup?.addEventListener('click', ()=>setTab('signup'));
      linkOpenSignup?.addEventListener('click', ()=>setTab('signup'));
      linkOpenLogin?.addEventListener('click',  ()=>setTab('login'));

      window.__influe_show_auth__ = showModal;
      window.__influe_hide_auth__ = hideModal;
      window.__influe_set_auth_tab__ = setTab;

      const y = document.getElementById('year');
      if (y) y.textContent = new Date().getFullYear();
    })();
  </script>

  <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
</body>
</html>
