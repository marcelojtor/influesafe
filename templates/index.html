{% extends "base.html" %}
{% block content %}
<main class="container main">

  <!-- ‚úÖ CARROSSEL DE PERSONAS (inser√ß√£o m√≠nima) -->
  <section id="persona-carousel" class="pc-wrap" aria-label="Perfis/Segmentos">
    <div class="pc-head">
      <h3 class="pc-title">Perfis</h3>
      <small class="pc-hint muted">Escolha seu segmento para personalizar dicas</small>
    </div>

    <div class="pc-track" tabindex="0" role="list" aria-label="Carrossel de perfis (rolagem horizontal)">
      <!-- preenchido via persona_carousel.js -->
    </div>

    <div class="pc-dots" aria-hidden="true"></div>

    <button id="persona-more" type="button" class="pc-more" aria-label="Ver mais perfis">ver mais</button>

    <!-- Sombras laterais (indicador de rolagem) -->
    <div class="pc-fade pc-fade-left" aria-hidden="true"></div>
    <div class="pc-fade pc-fade-right" aria-hidden="true"></div>
  </section>
  <!-- üîö CARROSSEL -->

  <section class="upload-card">
    <p class="muted">Bem-vindo ao <strong>INFLUE</strong></p>
    <h2 class="card-title">Fa√ßa upload e receba orienta√ß√£o inteligente</h2>

    <div class="actions">
      <form id="form-photo" class="upload" action="/analyze_photo" method="post" enctype="multipart/form-data">
        <input id="photo-input" type="file" name="photo" accept="image/*" hidden />
        <button type="button" class="btn btn-outline" id="btn-photo" aria-controls="photo-input">
          Enviar foto (JPG/PNG)
        </button>

        <div class="field" style="margin-top:.75rem;">
          <label for="intent" class="label">
            O que voc√™ quer que o INFLUE responda? <span class="muted">(at√© 140 caracteres)</span>
          </label>
          <input
            id="intent"
            name="intent"
            type="text"
            maxlength="140"
            placeholder="Ex.: Essa foto √© adequada para o LinkedIn?"
            aria-describedby="intent-help intent-counter"
            autocomplete="off"
          />
          <div class="flex between center-v" style="margin-top:.25rem;">
            <small id="intent-help" class="muted">Opcional. Uma frase curta orienta a an√°lise da IA.</small>
            <small id="intent-counter" class="muted">0/140</small>
          </div>
        </div>
      </form>

      <form id="form-text" class="upload" action="/analyze_text" method="post" enctype="application/json">
        <button type="button" class="btn btn-outline" id="btn-text">
          Enviar texto/legenda
        </button>
      </form>
    </div>

    <div class="text-area">
      <label for="textcontent" class="label">Cole sua legenda/texto:</label>
      <textarea id="textcontent" rows="4" placeholder="Digite ou cole aqui..."></textarea>
      <div class="right">
        <button type="button" class="btn btn-primary" id="btn-submit-text">Analisar texto</button>
      </div>
    </div>

    <!-- ALTERADO: ID exclusivo para feedback da p√°gina -->
    <div id="page-feedback" class="feedback" role="status" aria-live="polite"></div>

    <div id="analysis-output" class="analysis" style="display:none;">
      <h3>Resultado da an√°lise</h3>
      <p id="analysis-summary" class="muted"></p>
      <div class="chips">
        <div class="chip"><strong>Score de risco:</strong> <span id="analysis-score">‚Äî</span>/100</div>
        <div class="chip"><strong>Tags:</strong> <span id="analysis-tags">‚Äî</span></div>
      </div>
      <div class="recs">
        <strong>Recomenda√ß√µes:</strong>
        <ol id="analysis-recs"></ol>
      </div>
    </div>
  </section>

  <section class="hero-copy">
    <h1 class="title">Analise antes de postar.</h1>
    <p class="subtitle">Proteja sua imagem. Maximize seu alcance. IA que orienta voc√™ em segundos.</p>
    <ul class="bullets">
      <li>Cr√©ditos do usu√°rio para uso justo.</li>
      <li>Envie uma <strong>foto</strong> ou uma <strong>legenda/texto</strong>.</li>
      <li>Resultado imediato com <em>score</em>, <em>tags</em> e <em>recomenda√ß√µes</em>.</li>
    </ul>
  </section>
</main>

<script>
  (function () {
    const intent = document.getElementById('intent');
    const counter = document.getElementById('intent-counter');
    if (intent && counter) {
      const update = () => { counter.textContent = (intent.value || '').length + '/140'; };
      intent.addEventListener('input', update);
      update();
    }
  })();
</script>

<!-- ‚úÖ script do carrossel (adi√ß√£o m√≠nima) -->
<script src="{{ url_for('static', filename='js/persona_carousel.js') }}" defer></script>
{% endblock %}
